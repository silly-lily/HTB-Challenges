from Crypto.Util.number import long_to_bytes
from decimal import Decimal
from util import fifth_root

ct1 = 0x5E7335E270EB44B322AB95D794C4DF10A97EDEDB41EFEFC76CA22DAD71229382D38CBC4D5307969A487E72B1FA91E0DE61AF879A2F7E99987395EA249AD5BA57C73B1B068868D62EFA4E0DE98B2D35DE477D4BDFE731E655508A58D78689D8663C055FF7E63B7A33C15DA366B71725E209EB079421D551BD65993ACBC7EC8F1A
n1 = 0xBAE8A4016827B2304F4E2347781A357F7E371DFE85467F867E0FD915353C9818723E5E0B3344360E03AC82B65161FA1019FA35BFC85B2A26652E3DAAB41B61B16B4DAFDA1D92B2DB89C58BBE045F8952F77D6B155B0BD88FB3B20A5990E7C6AF893A93947FA8F172899E74ABA416B479DAF01B42A17892A58DD1932A20058AA7
e1 = 0x5

ct2 = 0x987B8CBF3BF60F400EC456E591F82133958698411C2AE4CB7EC7827B0C94842B9A74E2842E2667715DA243B5B793383C9D704DB94583891F703A61D56F32699EEDBB62436C2EDD4422D8B98EC45D88EA6648F60F1E581AB50D19CA9E56117EBEE97AF7C337183592A4AC52F23E6F1BA03138D0B545030ABE0ABB69343AAEFA24
n2 = 0x9C60E659E5DFE78BC410253E71033A42ACFB3F739383F36ECD973384CFC471A21C0C517A64C2D874F7DE9F828CDD2DF830A8B4C63904981346C710ADE2866F31D6D819A39BB4C108B71989B86D663CD0811A44F751BB751FD4C78A62C8447DA6B6A2FB52DC9432E47E4BCDBEA1EA40EFFEF52474FF52FBFF11D947DAC4B51701
e2 = 0x5

ct3 = 0x49EDBB221AE962B06DE4F92AAB08E76A46EEAC2E8F216E7621502B0154322B5F63E7CCC1CCD82C1DBE6AA0967016DDD9CF50A788EE6BA9B7BCABE5CC463E4B1C2C4F94FB32437AE413BCC97B35D6825E1CB900DB3C9E05468237FE4FAF932D97F77272F2C41F003577EDCBB03B982B90ED0BF8615C1365F0671313F990FC105A
n3 = 0x5F36BD4D7333DDDE9D4ACDD333FDD1220FEE85746379C453A7992A3F603BD25174CAEA1E2C0BEE2C05A12DD98B2CFE609F3C2F74E3EEC6B0709B64242D6007AE6942E1964A32DC7083398E52416F8E95B96ABBFEB7C254F65FC45AD244EA5AF86424979EE53D616688D07292FDC2E14735CC30D1FA5221D82D94DB58FBBFFC3D
e3 = 0x5

M = n1*n2*n3

M1 = M//n1
M2 = M//n2
M3 = M//n3

x1 = pow(M1, -1, n1)
x2 = pow(M2, -1, n2)
x3 = pow(M3, -1, n3)

m5 = ct1*M1*x1+ct2*M2*x2+ct3*M3*x3
m5%=M

m = fifth_root(m5)
m = long_to_bytes(m)
print(m)